cmake_minimum_required(VERSION 3.27.5)

project(game VERSION 0.1.0)

# Options and variables, that could be changed
option(DEBUG_MODE "If toggled ON - logs messages to opened console or file. See logger.h for logger usage" ON)
option(USE_SDL "If toggled OFF - SDL2 libraries will not be added to build" ON)

set(CMAKE_RUNTIME_OUTPUT_DIRECTORY "${CMAKE_SOURCE_DIR}/build")

set(SDL2_DIR "${CMAKE_SOURCE_DIR}/lib/SDL2-2.28.5/cmake")
set(SDL2_image_DIR "${CMAKE_SOURCE_DIR}/lib/SDL2_image-2.8.2/cmake")
set(SDL2_ttf_DIR "${CMAKE_SOURCE_DIR}/lib/SDL2_ttf-2.22.0/cmake")

# Don't change the code below
if (DEBUG_MODE)
  add_definitions(-D_DEBUG)
endif()

file(GLOB PROJECT_SRC "src/*.cpp")
file(GLOB SDL2_GFX_SRC "lib/SDL2_gfx-1.0.4/*.c")

set(CMAKE_CXX_FLAGS "${CMAKE_CXX_FLAGS} -static")

if (USE_SDL)
    find_package(SDL2 REQUIRED)
    find_package(SDL2_image REQUIRED)
    find_package(SDL2_ttf REQUIRED)

    add_executable(game WIN32 ${PROJECT_SRC} ${SDL2_GFX_SRC})

    target_link_libraries(game SDL2::SDL2main SDL2::SDL2 SDL2_image::SDL2_image SDL2_ttf::SDL2_ttf)
    target_include_directories(game PUBLIC "${CMAKE_SOURCE_DIR}/include" "${CMAKE_SOURCE_DIR}/lib/SDL2_gfx-1.0.4" "${CMAKE_SOURCE_DIR}/lib/doctest.h")
else()
    add_executable(game ${PROJECT_SRC})

    target_include_directories(game PUBLIC "${CMAKE_SOURCE_DIR}/include")
endif()